<!DOCTYPE html>
<html>
{% extends "base.html" %}
{% block title %}Quiz{% endblock %}

{% block content %}

<script>
storageUtils.storeSessionValue(storageUtils.testID, 1);
displayResults = (data) => {
    //code here... the parameter 'data' comes from request.ajax, it's what was returned from the API
    const answersSection = document.getElementById('quiz-radio-section');
    var gainedCredit = 0;
    data.quizzes.forEach((question) => {
    	const quizTitle = document.getElementById('quiz-title');
	    if(question.type === 'multiple_choice'){
	    	// Create title and the body of the question
	    	var title = elemUtils.createElement({type: 'h1', className: 'quiz-title', innerHTML: question.title, parent: quizTitle});	    	
	    	var body = elemUtils.createElement({type: 'h2', className: 'quiz-title', innerHTML: question.text_body, parent: quizTitle});
		    var quizSection = elemUtils.createElement({type: 'div', parent: quizTitle});
		    var correctAndSelected = null; 
		    var wrongAndSelected = null; 
		    question.answers.forEach((answer) => { //answers is also a list so it can be iterated
		        // Create a container to hold the body of the answer
		        // Then create a 'p' to display the answer body
			    var answerContainer = elemUtils.createElement({type: 'div', className: "row quiz-radio-row", parent: quizSection});				
	        	var answerBody = elemUtils.createElement({type: 'p', className: 'answer', innerHTML: answer.body, parent: answerContainer});
		        // Check if the answer is correct or not and that is selected, then highlight it accordingly
		        if(answer.is_correct && answer.is_selected){
		        	answerBody.innerHTML = answer.body;
		        	answerBody.style.borderColor = "green";
		  			answerBody.style.borderStyle = "solid";
		  			answerBody.style.backgroundColor = "lightgreen";
		  			// gainedCredit += question.credit_value;
		  			correctAndSelected = true;			  			
		  		}else if(!answer.is_correct && answer.is_selected){
		  			//elemUtils.createElement({type: 'p', className: 'answer', innerHTML: answer.body, parent: some});
		  			answerBody.innerHTML = answer.body;
		  			answerBody.style.borderColor = "red";
		  			answerBody.style.borderStyle = "solid";
		  			answerBody.style.backgroundColor = "pink";		
		  			wrongAndSelected = true;
		  		}   
		    }) 
		    var feedback = elemUtils.createElement({type: 'p', className: 'feedback', parent: quizSection});
		    if(correctAndSelected){
		    	feedback.innerHTML = 'You answer is correct, and the credit gained is ' + gainedCredit;
		    }else if(wrongAndSelected){
		    	feedback.innerHTML = 'You answer is wrong!';
		    }correctAndSelected
		    
		}
	});
}
request.ajax({endpoint: 'tests', extension: storageUtils.getSessionValue(storageUtils.testID), handler: displayResults});
//this is for the HTML tag


</script>
<div class="grid-body-item contents column quiz-body">
	<div >	
		<div id="quiz-title">
			
			
		</div>
		
	</div>
<div id="quiz-radio-section" class="column quiz-radio-section" style="display: none;"></div>
		<div id="answers" class="answers">

			<div id="quiz-radio-section" class="column quiz-radio-section" style="display: none;"></div>
			
			<p id="feedback"></p>
		</div>
		
</div>
{% endblock %}

</html>